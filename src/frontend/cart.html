<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300..700&family=Inria+Sans:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Lexend+Deca:wght@100..900&family=Lora:ital,wght@0,400..700;1,400..700&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="cart.css">
    <title>Cart â€“ RENTROPY</title>
</head>
<body>
    <header class="header">
        <a href="index.html" class="logo">
            <img src="../assets/logo.png" alt="RENTROPY" class="logo-img">
        </a>
        <nav class="nav">
            <a href="index.html" class="nav-link">Home</a>
            <a href="listing.html" class="nav-link">Listings</a>
            <a href="about.html" class="nav-link">About Us</a>
        </nav>
        <div class="header-actions">
            <a href="login.html" class="btn btn-signup">Sign Up</a>
            <a href="login.html" class="btn btn-login">Login</a>
            <a href="cart.html" class="header-cart header-cart--active" aria-label="Cart">ðŸ›’</a>
        </div>
    </header>

    <main class="page-main cart-page">
        <div class="container">
            <h1 class="page-title"> Your cart </h1>

            <div class="cart-layout">
            <div class="cart-items" style="max-height: 400px; overflow-y: auto;">
            </div>

                <aside class="cart-summary">
                    <h2 class="cart-summary-title"> Summary </h2>
                    <ul class="order-items">
                    </ul>
                    <a href="checkout.html" class="btn btn-primary btn-lg btn-block"> Proceed to checkout </a>
                    <a href="listing.html" class="cart-continue"> Continue shopping </a>
                </aside>

            </div>
        </div>
    </main>

    <script>
        // Local data for items
        const items = [
            { id: '1', name: '4-Person Camping Tent', category: 'Outdoor', price: 'â‚±200', image: '../assets/camping tent.jpg', brand: 'Green Outdoors Co.', description: 'Spacious 4-person tent, waterproof and easy to set up. Perfect for weekend trips. Well maintained and cleaned after each rental.' },
            { id: '2', name: 'DSLR Camera Kit', category: 'Electronics', price: 'â‚±1200', image: '../assets/camera.webp', brand: 'Camera Brand', description: 'Professional DSLR camera kit with lenses and accessories.' },
            { id: '3', name: 'Cordless Power Drill', category: 'Tools', price: 'â‚±800', image: '../assets/istockphoto-184639599-612x612.jpg', brand: 'Tool Co.', description: 'Powerful cordless power drill for all your DIY needs.' },
            { id: '4', name: 'Designer Handbag', category: 'Fashion', price: 'â‚±2500', image: '../assets/designer bag.jpg', brand: 'Fashion Brand', description: 'Elegant designer handbag, perfect for any occasion.' },
            { id: '5', name: 'Road Bike', category: 'Outdoor', price: 'â‚±1800', image: '../assets/road bike.jpg', brand: 'Bike Co.', description: 'High-performance road bike for cycling enthusiasts.' },
            { id: '6', name: 'HD Projector', category: 'Electronics', price: 'â‚±1500', image: '../assets/projector.jpg', brand: 'Projector Brand', description: 'High-definition projector for home entertainment.' },
            { id: '7', name: '2-Person Kayak', category: 'Outdoor', price: 'â‚±3500', image: '../assets/kayak.jpg', brand: 'Kayak Co.', description: 'Durable 2-person kayak for water adventures.' },
            { id: '8', name: 'Winter Sleeping Bag', category: 'Outdoor', price: 'â‚±1200', image: '../assets/sleeping bag.webp', brand: 'Outdoor Gear', description: 'Warm winter sleeping bag for cold weather camping.' },
            { id: '9', name: 'Men\'s Wool Blazer', category: 'Fashion', price: 'â‚±2800', image: '../assets/blazer.jpg', brand: 'Fashion Co.', description: 'Stylish men\'s wool blazer for formal occasions.' },
            { id: '10', name: 'Electric Lawn Mower', category: 'Tools', price: 'â‚±800', image: '../assets/lawn mower.jpg', brand: 'Tool Brand', description: 'Efficient electric lawn mower for garden maintenance.' },
            { id: '11', name: 'Camera Gimbal Stabilizer', category: 'Electronics', price: 'â‚±1500', image: '../assets/gimbal.jpg', brand: 'Gimbal Co.', description: 'Professional camera gimbal for smooth video recording.' },
            { id: '12', name: '60L Hiking Backpack', category: 'Outdoor', price: 'â‚±1200', image: '../assets/backpack.jpg', brand: 'Backpack Brand', description: 'Spacious hiking backpack for long treks.' },
            { id: '13', name: 'Evening Gown', category: 'Fashion', price: 'â‚±2800', image: '../assets/evening gown.jpg', brand: 'Fashion Brand', description: 'Elegant evening gown for special events.' },
            { id: '14', name: 'Pressure Washer', category: 'Tools', price: 'â‚±8500', image: '../assets/pressure washer.webp', brand: 'Tool Co.', description: 'High-pressure washer for cleaning tasks.' },
            { id: '15', name: '27" 4K Monitor', category: 'Electronics', price: 'â‚±15000', image: '../assets/monitor.webp', brand: 'Monitor Brand', description: 'Ultra-high-definition 27-inch monitor.' },
            { id: '16', name: 'Portable Camping Stove', category: 'Outdoor', price: 'â‚±1200', image: '../assets/camping stove.jpg', brand: 'Camping Gear', description: 'Compact portable camping stove for outdoor cooking.' },
            { id: '17', name: 'Formal Suit', category: 'Fashion', price: 'â‚±2800', image: '../assets/suit.png', brand: 'Suit Brand', description: 'Classic formal suit for professional settings.' },
            { id: '18', name: 'Circular Saw', category: 'Tools', price: 'â‚±8500', image: '../assets/circular saw.webp', brand: 'Tool Co.', description: 'Powerful circular saw for woodworking.' }
        ];

        function loadCart() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const cartItems = document.querySelector('.cart-items');
            const orderItems = document.querySelector('.order-items');
            let total = 0;
            let itemCount = 0;

            cartItems.innerHTML = '';
            orderItems.innerHTML = '';

            if (cart.length === 0) {
                cartItems.innerHTML = '<p>Your cart is empty.</p>';
                orderItems.innerHTML = '';
                return;
            }

            cart.forEach((item, index) => {
                // Ensure correct price
                item.priceNum = parseInt(item.price.toString().replace(/[â‚±$,]/g, ''));
                const itemTotal = item.priceNum * item.quantity;
                total += itemTotal;
                itemCount += item.quantity;

                const cartItem = document.createElement('article');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `

                    <div class="cart-item-image">
                        <img src="${item.image}" alt="${item.name}" width="160" height="120">
                    </div>

                    <div class="cart-item-details">

                        <h2 class="cart-item-title"><a href="product.html?id=${item.id}">${item.name}</a></h2>

                        <p class="cart-item-brand">${item.brand}</p>

                        <p class="cart-item-price">â‚±${itemTotal}</p>
                    
                        <button onclick="duplicateItem(${index})">Duplicate</button>

                        <button class="cart-item-remove" onclick="removeItem(${index})">Remove</button>
                        
                    </div>
                `;
                cartItems.appendChild(cartItem);

                for (let i = 0; i < item.quantity; i++) {
                    const li = document.createElement('li');
                    li.textContent = `${item.name} - â‚±${item.priceNum}`;
                    orderItems.appendChild(li);
                }
            });

            const serviceFee = Math.round(total * 0.1); // 10% service fee
            const finalTotal = total + serviceFee;

            // Add subtotal and total to the list
            const subtotalLi = document.createElement('li');
            subtotalLi.textContent = `Subtotal (${itemCount} item${itemCount > 1 ? 's' : ''}): â‚±${total}`;
            subtotalLi.style.fontSize = '1.2em';
            subtotalLi.style.fontWeight = 'bold';
            orderItems.appendChild(subtotalLi);

            const serviceLi = document.createElement('li');
            serviceLi.textContent = `Service Fee (10%): â‚±${serviceFee}`;
            orderItems.appendChild(serviceLi);

            const totalLi = document.createElement('li');
            totalLi.textContent = `Total: â‚±${finalTotal}`;
            totalLi.style.fontSize = '1.2em';
            totalLi.style.fontWeight = 'bold';
            orderItems.appendChild(totalLi);

            // Save corrected cart
            localStorage.setItem('cart', JSON.stringify(cart));
        }

        function updateDuration(index, newDuration) {
            const cart = JSON.parse(localStorage.getItem('cart'));
            cart[index].duration = parseInt(newDuration);
            localStorage.setItem('cart', JSON.stringify(cart));
            loadCart();
        }

        function duplicateItem(index) {
            const cart = JSON.parse(localStorage.getItem('cart'));
            cart[index].quantity += 1;
            localStorage.setItem('cart', JSON.stringify(cart));
            loadCart();
        }

        function removeItem(index) {
            const cart = JSON.parse(localStorage.getItem('cart'));
            cart.splice(index, 1);
            localStorage.setItem('cart', JSON.stringify(cart));
            loadCart();
        }

        // Check login status and hide/show buttons
        document.addEventListener('DOMContentLoaded', function() {
            const currentUser = localStorage.getItem('currentUser');
            const signUpBtn = document.querySelector('.btn-signup');
            const loginBtn = document.querySelector('.btn-login');
            const headerActions = document.querySelector('.header-actions');
            if (currentUser) {
                // User is logged in, hide login and signup buttons, add profile icon
                if (signUpBtn) signUpBtn.style.display = 'none';
                if (loginBtn) loginBtn.style.display = 'none';
                // Add profile icon beside cart
                const cartLink = document.querySelector('.header-cart');
                if (cartLink) {
                    const profileLink = document.createElement('a');
                    profileLink.href = 'dashboard.html';
                    profileLink.className = 'header-profile';
                    profileLink.setAttribute('aria-label', 'Profile');
                    profileLink.textContent = 'ðŸ‘¤';
                    cartLink.insertAdjacentElement('afterend', profileLink);
                }
            }
        });

        window.onload = loadCart;
    </script>
</body>
</html>
